{"componentChunkName":"component---src-templates-blog-post-js","path":"/aprendendo-sobre-testes-e-tdd/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://devjuniorplus.com.br"}},"markdownRemark":{"fields":{"slug":"/aprendendo-sobre-testes-e-tdd/"},"frontmatter":{"description":"Vamos aprender sobre essa prática tão importante que é o TDD","title":"TDD na pratica com Jest","date":"26 de setembro de 2020","image":"assets/images/david-travis-wc6mj0krzgw-unsplash.jpg"},"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAADAAH/2gAMAwEAAhADEAAAAekq2xkURf/EABsQAAIBBQAAAAAAAAAAAAAAAAECEgMQESEy/9oACAEBAAEFAmchpnC81BuIt//EABYRAQEBAAAAAAAAAAAAAAAAABEBEP/aAAgBAwEBPwFhn//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/Aaf/xAAZEAACAwEAAAAAAAAAAAAAAAAAARARMWH/2gAIAQEABj8Co0Quz//EABwQAQACAQUAAAAAAAAAAAAAAAEAETEhQVFhkf/aAAgBAQABPyFmHbiWpMeolRzBfVAbKlVoT//aAAwDAQACAAMAAAAQ0w//xAAXEQEBAQEAAAAAAAAAAAAAAAABACER/9oACAEDAQE/EOYyUXL/xAAXEQADAQAAAAAAAAAAAAAAAAABEBEh/9oACAECAQE/EBqL/8QAGRABAQEBAQEAAAAAAAAAAAAAAREAITFR/9oACAEBAAE/EJAwDOsCp9cUyoVHXD6SojiyTGgY+3AIEDw3/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"Quadro com varios card e uma pessoa segurando um dos cards escrito: run a usability test\"\n        title=\"Quadro com cards e test\"\n        data-src=\"/static/3338d2d8702e8c07f9be093f8f2b4146/18e3b/david-travis-wc6mj0krzgw-unsplash.jpg\"\n        data-srcset=\"/static/3338d2d8702e8c07f9be093f8f2b4146/46946/david-travis-wc6mj0krzgw-unsplash.jpg 240w,\n/static/3338d2d8702e8c07f9be093f8f2b4146/55489/david-travis-wc6mj0krzgw-unsplash.jpg 480w,\n/static/3338d2d8702e8c07f9be093f8f2b4146/18e3b/david-travis-wc6mj0krzgw-unsplash.jpg 960w,\n/static/3338d2d8702e8c07f9be093f8f2b4146/60e21/david-travis-wc6mj0krzgw-unsplash.jpg 1440w,\n/static/3338d2d8702e8c07f9be093f8f2b4146/69b48/david-travis-wc6mj0krzgw-unsplash.jpg 1920w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li><a href=\"#introducao\">Introdução</a></li>\n<li><a href=\"#o-bug-mais-caro\">O Bug mais caro do mundo</a></li>\n<li><a href=\"#tipos-de-testes\">Tipos de testes</a></li>\n<li><a href=\"#tdd-o-que\">TDD, o que é?</a></li>\n<li><a href=\"#diga-nao\">Diga não ao console.log()</a></li>\n<li><a href=\"#red-green-refactor\">TDD: Red, Green e Refactor</a></li>\n<li><a href=\"#framework\">Framework para testes</a></li>\n<li><a href=\"#projeto\">Iniciando nosso projeto</a></li>\n<li><a href=\"#criando-primeiro-teste\">Criando nosso primeiro teste</a></li>\n<li><a href=\"#melhorando-teste\">Melhorando nosso teste</a></li>\n<li><a href=\"finalizando-testes\">Finalizando nossos casos de testes</a></li>\n<li><a href=\"#conclusao\">Conclusão</a></li>\n</ul>\n<br />\n<h2 id=\"introducao\">Introdução</h2>\n<p>Um dos principais objetivos em fazermos testes de software, é ter a garantia de qualidade.</p>\n<p>Por meio dos testes, podemos melhorar a estabilidade, funcionalidades, usabilidade, performance e claro, a segurança do nosso software.</p>\n<p>E por mais que ainda parece que os custos e tempo para fazermos os testes sejam altos, a história de resultados catastróficos causados por falhas em software, nos diz que sim, vale a pena termos testes.</p>\n<br />\n<h2 id=\"o-bug-mais-caro\">O bug mais caro do mundo</h2>\n<p>A sonda Mars Climate Orbiter (MCO) foi projetada pelos EUA e lançada em dezembro de 1998, com o objetivo de permitir o estudo do clima em Marte.</p>\n<p>Porém, o MCO foi destruído ao entrar na atmosfera de Marte.</p>\n<h3>Por que?</h3>\n<p>Por um erro de cálculo, pois os desenvolvedores utilizaram a medida inglesa de unidades, já o sistema do MCO realizavam cálculos com o sistema métrico.</p>\n<h3>Resultado</h3>\n<p>O MCO explodiu na atmosfera marciana, custando 193,1 milhões USD. (Se hoje já é uma fortuna, imagina em 1998).</p>\n<p><code class=\"language-text\">Esse é um exemplo extremo de erro envolvendo software, mas serve para entendermos que quando se trata de bug, o céu é o limite para o que ele pode causar.</code></p>\n<br />\n<h2 id=\"tipos-de-testes\">Tipos de testes</h2>\n<p>Agora que já entendemos a importância dos testes em nossos projetos, precisamos entender os tipos de testes que podemos ter.</p>\n<p>Existem várias nomenclaturas e vários tipos diferentes, mas podemos resumir em dois:</p>\n<ul>\n<li>Testes unitários</li>\n<li>Testes de integração</li>\n</ul>\n<h3>Testes unitários</h3>\n<p>São testes feitos de forma isolada, ou seja, testamos pequenos pedaços do nosso código (por exemplo classes ou funções).</p>\n<p><strong>Objetivo</strong>: nos testes unitários, precisamos testar se o código está se comportando como o <strong>desenvolver</strong> espera.</p>\n<h3>Testes de integração</h3>\n<p>São testes feitos para checar se as unidades funcionam entre si, ou seja, se quando integrados com outras unidades do projeto, a integração funciona (por exemplo, múltiplas classes e funções).</p>\n<p><strong>Objetivo</strong>: nos testes de integração, precisamos testar se o software funciona como o <strong>usuário</strong> espera.</p>\n<br />\n<h2 id=\"\">TDD, o que é?</h2>\n<p>Test-Driven Development ou, Desenvolvimento orientado à Testes foi descoberto em 2003 por Kent Beck, engenheiro de software americano, criador também do Extreme Programming (XP). Ele ainda foi um dos 17 signatários originais do Agile Manifesto em 2001.</p>\n<p>Na prática, é uma abordagem de desenvolvimento onde primeiro escrevemos nossos testes e depois criamos nosso código, ou seja, precisamos saber qual será o resultado que o código irá gerar, assim nosso teste já <strong>espera</strong> esse resultado.</p>\n<p>*-Guarde a palavra <strong>espera*</strong>.</p>\n<p>O TDD se baseia em testes unitários, mas <strong>não quer dizer</strong> que se aplica apenas a testes unitários.</p>\n<p>Como se os testes unitários fossem a <strong>ferramenta</strong>, e o TDD é a técnica.</p>\n<br />\n<h2 id=\"diga-nao\">Diga não ao console.log()</h2>\n<p>Que atire a primeira pedra quem nunca debugou um código com um console.log().</p>\n<p>Mas sabemos, no fundo, que essa não é a melhor forma de testar nosso código (certo?!).</p>\n<p>Então sempre que acharmos um bug em nosso código, com certeza, é hora de escrever um teste.</p>\n<br />\n<h2 id=\"red-green-refactor\">TDD: Red, Green e Refactor</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 529px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.58333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADUklEQVR42oVUe0hTURi/URAYif8V9iIiyAxMC/9IqCCKCCICCZIagX+kKGoP3CPzkesJli4te4m52VRo6IwsdHcPzfnKoSn2AOfM6R7aNrsyd+8993TOudt6QofD4Xzf+X7n+/2++51LwX8OQcDrchDPqPnXoP4B5AGOfVoNE+Phznj4tAZ7ef5/YAEClsObXjNcuxImxMPETXANhU00OPYPCr+BAQDogmlnYL6oGCZtFR7XQPUzuGMDLJXDabsY8SueimgUyNXc60ftDTeavtEWmLYbHEwFh/YJacnQ8BYWX4aq25AlySN4SmSLRXH8C6WGfmEIX9vZASWn4Nl02PUm7Kl/BIsuQo6LlhCDBVIg/QO9UUtjahyuzZTHO2SzjY6PT865MVsRg/AVyjB/BBYJT41PqUsbIrLRKgQ8zq8O++zMV7/HyRNnuODyfDgyLOIpwOMDfU3rWM8YCeBFRXVW74F7Y2jW982LygR0hHYmA7x7k4B5SlTbqNQsBZZwzYiEWrNzVZYpNs8Sk22iMmlk4jByBP0+KL/4U7Pf62+508yG2EBg0e/zoRzJZYPHVKPP+1wq48x5zaek0kEU5vF6Z5wzIdRDZYWCxx0Be3y6St20c7p/qN9I0/MLC3vK36dcG6w1zz55N1fQ/GVXyQAibenp7u6yMMwyVF4F7rkwOMgE9VVtulu6iZ4JkdvNDgd1zrBZat2m6FudZb7R4UDOJSbYOt4qNUqbXimXg0wY3Fiuzlh/Oj+hIGd7rvWlFXlYDpTo7Rtl1g3S3mK9PUTqrP2kja2Ni30YR91acaFTjsGLCwHFUZkqu0qj0KgL1SqJKtpwLC+w5FsAYh7WHblkvnR3qOJsW2bCw90uxkUhzoqj8sJDl5Xp5bdP3GnIU5Oa8zwINyHacAB3iOSt5Hjb8Qx95t66/UmPUwPLi5i2ucV8ZkvGybgTuSk5nbRB7DkBJ0TNImbGq/Zj87r7GykFRV2PeTaqIZrJ/XOTszba5nP5KoarC+niEfcHlmfFjmYBi0zkrBx4MPvd1f6l4+PCZ9I2ws/ejg6To1tuKivokl0xl6NZ0ClTmMqMju7fHi/hQkVfMsAqBSHy3BiWsfunJv0OJsRE/hQoC+DxjwaInh8EveaaYKCGfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"Ciclo do TDD, red green, refactor\"\n        title=\"Ciclo do TDD, red green, refactor\"\n        data-src=\"/static/585f62b6f4ea721b77b8c596f491d793/28906/tdd.png\"\n        data-srcset=\"/static/585f62b6f4ea721b77b8c596f491d793/5243c/tdd.png 240w,\n/static/585f62b6f4ea721b77b8c596f491d793/ab158/tdd.png 480w,\n/static/585f62b6f4ea721b77b8c596f491d793/28906/tdd.png 529w\"\n        sizes=\"(max-width: 529px) 100vw, 529px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Esse é o ciclo do TDD: Red, Green e Refactor.</p>\n<h3>Red</h3>\n<p>Primeiro escrevemos um teste para que ele falhe. Sim! Ele deve falhar. Pois o código ainda nem existe, lembra?</p>\n<h3>Green</h3>\n<p>Agora devemos escrever a solução mais simples para que o teste passe.</p>\n<h3>Refactor</h3>\n<p>Agora escrevemos de fato nosso código por completo, toda a funcionalidade e testamos novamente. </p>\n<p><code class=\"language-text\">Caso não passe, devemos voltar a etapa anterior.</code></p>\n<blockquote>\n<p>Primeiro faça, depois faça certo e por fim, faça melhor! </p>\n</blockquote>\n<br />\n<h2 id=\"framework\">Framework para testes</h2>\n<p>Existem inúmeros frameworks para criarmos nossos testes. Nesse post, vamos utilizar o <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Jest</a>.</p>\n<br />\n<h2 id=\"projeto\">Iniciando nosso projeto</h2>\n<p>Nesse post, vamos criar uma aplicação simples para podermos começar a entender e escrever nossos testes. Iremos criar uma função de soma, onde receberá dois parâmetros inteiros.</p>\n<p>Primeiro, vamos executar <code class=\"language-text\">yarn init -y</code> para criarmos o package.json.</p>\n<p>Depois, vamos instalar o Jest, com o seguinte comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> jest -D</code></pre></div>\n<p>Agora, vamos criar um script para executar nossos testes e nosso <code class=\"language-text\">package.json</code> deve estar semelhante a esse:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// package.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sum\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"jest\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"jest\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^26.4.2\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>Existe um Snippet do Jest para o VS Code, o que auxilia bastante na escrita dos testes. Basta procurar por \"Jest Snippets\" na loja  de extensões dentro do próprio VC Code e instalá-lo.</p>\n</blockquote>\n<br />\n<h2 id=\"criando-primeiro-teste\">Criando nosso primeiro teste</h2>\n<p>Podemos criar na raíz do nosso projeto, um arquivo <code class=\"language-text\">sum.spec.js</code>, é nesse arquivo que vamos criar nossos testes.</p>\n<p><code class=\"language-text\">O Jest por padrão, procura os arquivos que contenham &quot;spec&quot; ou &quot;test&quot; no nome.</code></p>\n<h3>Escrevendo o teste</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should sum 5 and 5 the result must be 10'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ao executar o teste <code class=\"language-text\">yarn test</code>, esse é o resultado:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 610px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeUlEQVR42n1U227TQBD11yAS5+KmsRPb8d3re+PYadJQmqY8IARCSEiIL+C/D8eblJaS8nA8O7ve2TlzdlapdzWKZomkaBC0e0TbDwjXB/irO0T5FvXqBo4v0B86GGruXxiM/51TivsDits7tNdbJPkatlNwsy1/Hpw2vYbhs/U/AX+VG3wXK3iiRd3cSXjBEuOJh9GFR+vLcWeffILjsxnWRojSyUirgkt4wZW0+iyGMRewFpm0pp1KK2EmmHL9ZcDOV/TLAJWVoCGEESHmAUtTQMxjZETDQLkZo+Z6Sj/kPwPNkThXU6VLP0paxGmLMKYwQY2ZmcH1rphdgYVTHeejFQYURiUGjxgd66eOnuqojPjRJgFpMEi8hFHl0NNMYuLHtKSa0BcptDiCFoTQoghjn3ADzK0UliMwmYYysKIx4IRZalMB3y9hixJWWMD0GNAI5HgRlDDdDGPTx9CgWDNa3cNwehTpYnoUTFKW3DUP03nG0wR6fQvqwEaf6Cj1VRs91Tr6w8WR5nO8pNwbWPKULnXTyXFJBWe0tltiqkfQ/RpmtoURtdCdEjOKc0zCPS9KUe2Q5htU9S0sBl1Tyc0ihecWENk1/KiWDEY8dEha/+sSmeHXbz9xePgCL6QgRowPvOiHrmN4XULRyDupsnPObX4l4A/ZHY5XYW5n2O0/IUzXeNOboyvH265+o4Vsx0eo9FU59zh/8gkloboR69VuHmTgdn2P5oRqeUu8Y58fZFks1tZir3edos8E65nKJDqrnzpIqYo9X5Q99ofP2L3/yI3XfCQ2WPHlycsbFFc7lERnu8udcN3xShk45BsQxCu4bNeOYVe23w8OA7PFTkNUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"imagem do terminal com erro ao executar o teste\"\n        title=\"imagem do terminal com erro ao executar o teste\"\n        data-src=\"/static/6c91c3440e6c0db43cef22099c24f7a2/574c5/1.png\"\n        data-srcset=\"/static/6c91c3440e6c0db43cef22099c24f7a2/5243c/1.png 240w,\n/static/6c91c3440e6c0db43cef22099c24f7a2/ab158/1.png 480w,\n/static/6c91c3440e6c0db43cef22099c24f7a2/574c5/1.png 610w\"\n        sizes=\"(max-width: 610px) 100vw, 610px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Logicamente, nosso teste não passou pois ainda nem criamos o arquivo <code class=\"language-text\">sum</code>. Então vamos escrevê-lo.</p>\n<br />\n<h2>sum.js</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sum</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">number1<span class=\"token punctuation\">,</span> number2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> number1 <span class=\"token operator\">+</span> number2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Rodando nosso <code class=\"language-text\">yarn test</code>:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 452px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVR42pWS21LbMBCG/TidQgIhSY1P8vkgOYpsJySN45SGAJMbGIYbpu1VeQxe9kfWTDiE9oKLHa1Wq9W/30rLQg6/mYCUBepmBpqPYbscQz3C4ZGDzjH5lGnFeIVZeQ4+qhEmFfxQIOcL6EaCLwemKvq28M7fxfdNc38twJ62sO7OYJgUZ/M1RNlAVA3oaI7+t1Amviro9si7B7o9F0fSXhR20xD9BYNblrAchiAqQOkMrsMRB5VsPYbpUIXAcUcwrEytFmEyztSqmwlsksOwKTTfFQiIQBRW4EUN4nF0DA/9LMVgzHBCYuinCYK4VGcHXfsds30kWv1ji9u7B0xlq4zP4fsCQ8Hg3ddIHi9gVwIe4VjKvHGxlFyNDxzf+tr68ha///zF5upGTniGrx0LebFAs9liUv9EXw8VCscbqVZbpieD4L8/QBPVCsvVNYansUrWzRRJNkUpB5OkU8mMqodoPgeTQ2q5mZLVfusvBT23VUBRTc8RpRUi+XUY/45yskJv4KuLreqdtftdsX+pfAZRBjsb/6q0+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"imagem do terminal com teste passando\"\n        title=\"imagem do terminal com teste passando\"\n        data-src=\"/static/f81ad14e2ead5507555cbd19f6026a28/39613/2.png\"\n        data-srcset=\"/static/f81ad14e2ead5507555cbd19f6026a28/5243c/2.png 240w,\n/static/f81ad14e2ead5507555cbd19f6026a28/39613/2.png 452w\"\n        sizes=\"(max-width: 452px) 100vw, 452px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3>Como ter certeza que o teste está correto?</h3>\n<p>O <code class=\"language-text\">expect</code> permite que nós negamos o que está após dele com o <code class=\"language-text\">not</code>. Com o teste passando, fazendo a negação, o teste precisa falhar, assim temos certeza que não é um falso-positivo.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>not<span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 571px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACh0lEQVR42o1USW7bQBDkbxJYoiRS3BdxG+6URHkT4ji+BIGB5A2+5ZBfl2tGtAw7gZFDo4fNnmJVL9TcqxHV4YD9YUSUDDCsDBd6CH21+S+bL+M3z9rP6wfsqkuI5hr78SvSfK9AZaKyRTT5+DVGm03x96Dan3KLfdoj72+xPdyj298hr6+wtHMYroDpVVg5BQyvhOEIFbN4dgPGzfQNmDxrsVtgu+mQ0ReeQEyg0i+R8mJB38ct4yXasOFzBUEgx8qxoi2M5A1rxVACNARSgE6OlHIFwWKykgAVAWI3Q+4X2DAn4ztbloSXF9IIKpmeGa4I6Gdb+EENwcTaShGFFULWsqD0qB0x7wX0rsQyKpTsMOnhk7HDD4ZUF8QdTOIoQJdAHetXsDGyy2E2YJGQgR5hxm7P5xF0PT6bbM5MvpNNmfzFQvqTbE0nZcOusLYF60LqNqmvT6ZbrJH1+qzOtIWdqHfKr0+SDd6V8jVD1mAt4Ec90nYPb6Sc7QCvbWGJCi69UzcIBrLfDTzXWIoCq6zAsuQURDkCyvdjoWSfAM0CJmvjhzUsMrXdEpbFehkpTHbTYmLIelkWL8lReZlJev08l5Nk2S3dYGOiFrZXqC1RCTJxNdl04RQ7dVbGVWffbY4mk23OmR9J2pTHJgXsYpwOZEq26Q5Bd4TXHOFkLMnU3fcrdwas2hu0/RFVd4sNpV1y1m4oPSBwI7tfHqbdjv8a4n+Bak9Pv3F3/0PNUklmv66/4XF7C48rJz8kx0mOhpT50U/hDHj38IiQYEsz4cAO6LnPDuv56cKnefg88xXDl9p+BKYAG+5rTdnHL9+VxJGAbXcDwS3JxYgk36lzSv+yux/9zp4BH1McgbQEWI8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"imagem do terminal com teste dando erro novamente\"\n        title=\"imagem do terminal com teste dando erro novamente\"\n        data-src=\"/static/2450ad1d0931579e98e08b4bab2354b8/0766b/3.png\"\n        data-srcset=\"/static/2450ad1d0931579e98e08b4bab2354b8/5243c/3.png 240w,\n/static/2450ad1d0931579e98e08b4bab2354b8/ab158/3.png 480w,\n/static/2450ad1d0931579e98e08b4bab2354b8/0766b/3.png 571w\"\n        sizes=\"(max-width: 571px) 100vw, 571px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<br />\n<h2 id=\"melhorando-teste\">Melhorando nosso teste</h2>\n<p>Como sabemos, o Javascript permite algumas coisas, digamos, estranhas. </p>\n<p>Por exemplo, se somarmos:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">return</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span> <span class=\"token comment\">// resultado = 5</span></code></pre></div>\n<p>Nada de novidade até aqui. Porém, se fizermos: </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">return</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"3\"</span> <span class=\"token comment\">// resultado = 23</span></code></pre></div>\n<p>Nesse exemplo, o que acontece é que, como o 3 é uma string, o JS converte o 2 para uma string também, e por fim, concatena os dois, resultando em uma string \"23\". Sabendo que isso pode acontecer, precisamos previnir isso com um teste.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should sum 5 and 5 even if on of them is a string and the result must be 10'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'5'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBe</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>No <code class=\"language-text\">sum.js</code>, precisamos assegurar que os números passados via parâmetro sejam números e não string.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span>sum <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> number1<span class=\"token punctuation\">,</span> number2 <span class=\"token punctuation\">}</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> int1 <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>number1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> int2 <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>number2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">return</span> int1 <span class=\"token operator\">+</span> int2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>Dica: Existe uma forma pouco conhecida de transformar uma variável em um número, usando o operador \"+\".</p>\n<p>Exemplo: </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">return</span> <span class=\"token operator\">+</span>num1 <span class=\"token operator\">+</span> <span class=\"token operator\">+</span>num2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ambas variáveis serão convertidas para números</span></code></pre></div>\n<p>OBS.: Cuidado, pois caso seja passado uma string vazia (\"\"), será retornado 0, e não um NaN, como é de se esperar.</p>\n</blockquote>\n<p>Nosso teste está passando agora:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVR42p1Ry07DMBD076CW9EFITJx34jqvJi1NxaPAoaCeOPH/0rB2Gw6IQ+lhtOO1NTs7Zmm7Rr3s4EcVpjcJRpaP62l4MVh5eEGcdCibB0Rpi5mdGtGRFWA8CU7cN3w4D/wvsGjfQ8oNmu4JdfOIJOvgegp3fgEuCoiwIl6CU88LjnUyj2lwYjb6DeaLyojYPMdc5HACBRFUJFTD4QvccmkG2A7dEedCmZ6Gc6oD9Bu2//g0ztxFhexrh/B9izhqserfYM0iXI29n7XPAdu9HoyDkPJ7Ji7LnhyvoMotfVQN281NNmd/ilQbZHKNXN2jIBGdj85CZ6S5dvkfwW+Adeypffj8YQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image lazyload\"\n        alt=\"imagem do terminal com teste passando e finalizado\"\n        title=\"imagem do terminal com teste passando e finalizado\"\n        data-src=\"/static/8fc19d08ecccf1ba67870d7b504d35ef/62d75/4.png\"\n        data-srcset=\"/static/8fc19d08ecccf1ba67870d7b504d35ef/5243c/4.png 240w,\n/static/8fc19d08ecccf1ba67870d7b504d35ef/ab158/4.png 480w,\n/static/8fc19d08ecccf1ba67870d7b504d35ef/62d75/4.png 697w\"\n        sizes=\"(max-width: 697px) 100vw, 697px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Agora, podemos verificar se a soma pode ser executada, mesmo depois das variáveis serem convertidas para números, pois pode ser um <code class=\"language-text\">NaN</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should throw an error if what is provided to the method connot be summed'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toThrowError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E precisamos criar a verificação no <code class=\"language-text\">sum.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span>sum <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> number1<span class=\"token punctuation\">,</span> number2 <span class=\"token punctuation\">}</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> int1 <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>number1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> int2 <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>number2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>int1<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> Number<span class=\"token punctuation\">.</span><span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>int2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \t<span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Please, check your input.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">return</span> int1 <span class=\"token operator\">+</span> int2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br />\n<h2 id=\"finalizando-testes\">Finalizando nossos casos de testes</h2>\n<p>Agora podemos apenas acrescentar testes para verificar se as entradas são Arrays, objetos ou sejam vazios.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should throw an error if what is provided to the method connot be summed'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toThrowError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Não pode ser um array</span>\n\t<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toThrowError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token comment\">// Não pode ser um objeto</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toThrowError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n\t <span class=\"token comment\">// Não pode ser passado vazio</span>\n   <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toThrowError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Para um função extremamente simples, conseguimos cobrir muitos casos de testes. XD</p>\n<hr />\n<h2 id=\"conclusao\">Conclusão</h2>\n<p>Nesse post aprendemos um pouco sobre TDD, as motivações de escrevermos testes em nossos projetos, sejam pequenos ou, principalmente em grandes e aplicamos tudo isso na prática utilizando o Jest.</p>\n<p>Espero ter motivado você a escrever testes, caso ainda não fazia e continuar escrevendo, se já rodava testes em seus projetos.\nO código feito nesse post está no Github, <a href=\"https://github.com/jjunior96/test-exemple-blog\" target=\"_blank\" rel=\"noopener noreferrer\">aqui</a>.</p>\n<p>Obrigado por ter lido até aqui! Grande abraço e até a próxima.</p>","timeToRead":7}},"pageContext":{"slug":"/aprendendo-sobre-testes-e-tdd/","previousPost":{"fields":{"slug":"/aprendendo-typescript-parte-1/"},"frontmatter":{"title":"Aprendendo TypeScript - Parte 1"}},"nextPost":{"fields":{"slug":"/aprendendo-mais-sobre-git/"},"frontmatter":{"title":"Aprendendo mais sobre Git"}}}},"staticQueryHashes":["2037742868","3149229692","764694655"]}